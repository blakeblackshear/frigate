{"version":3,"sources":["vs/editor/contrib/anchorSelect/browser/anchorSelect.ts"],"names":[],"mappings":"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","file":"anchorSelect.js","sourceRoot":"file:///mnt/vss/_work/1/s/dependencies/vscode/out-editor-src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { KeyChord, KeyCode, KeyMod } from '../../../../base/common/keyCodes.js';\nimport { IDisposable } from '../../../../base/common/lifecycle.js';\nimport './anchorSelect.css';\nimport { ICodeEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction, EditorContributionInstantiation, registerEditorAction, registerEditorContribution, ServicesAccessor } from '../../../browser/editorExtensions.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IEditorContribution } from '../../../common/editorCommon.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { TrackedRangeStickiness } from '../../../common/model.js';\nimport { localize, localize2 } from '../../../../nls.js';\nimport { IContextKey, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { KeybindingWeight } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\n\nexport const SelectionAnchorSet = new RawContextKey('selectionAnchorSet', false);\n\nclass SelectionAnchorController implements IEditorContribution {\n\n\tpublic static readonly ID = 'editor.contrib.selectionAnchorController';\n\n\tstatic get(editor: ICodeEditor): SelectionAnchorController | null {\n\t\treturn editor.getContribution<SelectionAnchorController>(SelectionAnchorController.ID);\n\t}\n\n\tprivate decorationId: string | undefined;\n\tprivate selectionAnchorSetContextKey: IContextKey<boolean>;\n\tprivate modelChangeListener: IDisposable;\n\n\tconstructor(\n\t\tprivate editor: ICodeEditor,\n\t\t@IContextKeyService contextKeyService: IContextKeyService\n\t) {\n\t\tthis.selectionAnchorSetContextKey = SelectionAnchorSet.bindTo(contextKeyService);\n\t\tthis.modelChangeListener = editor.onDidChangeModel(() => this.selectionAnchorSetContextKey.reset());\n\t}\n\n\tsetSelectionAnchor(): void {\n\t\tif (this.editor.hasModel()) {\n\t\t\tconst position = this.editor.getPosition();\n\t\t\tthis.editor.changeDecorations((accessor) => {\n\t\t\t\tif (this.decorationId) {\n\t\t\t\t\taccessor.removeDecoration(this.decorationId);\n\t\t\t\t}\n\t\t\t\tthis.decorationId = accessor.addDecoration(\n\t\t\t\t\tSelection.fromPositions(position, position),\n\t\t\t\t\t{\n\t\t\t\t\t\tdescription: 'selection-anchor',\n\t\t\t\t\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\t\t\t\t\thoverMessage: new MarkdownString().appendText(localize('selectionAnchor', \"Selection Anchor\")),\n\t\t\t\t\t\tclassName: 'selection-anchor'\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t\tthis.selectionAnchorSetContextKey.set(!!this.decorationId);\n\t\t\talert(localize('anchorSet', \"Anchor set at {0}:{1}\", position.lineNumber, position.column));\n\t\t}\n\t}\n\n\tgoToSelectionAnchor(): void {\n\t\tif (this.editor.hasModel() && this.decorationId) {\n\t\t\tconst anchorPosition = this.editor.getModel().getDecorationRange(this.decorationId);\n\t\t\tif (anchorPosition) {\n\t\t\t\tthis.editor.setPosition(anchorPosition.getStartPosition());\n\t\t\t}\n\t\t}\n\t}\n\n\tselectFromAnchorToCursor(): void {\n\t\tif (this.editor.hasModel() && this.decorationId) {\n\t\t\tconst start = this.editor.getModel().getDecorationRange(this.decorationId);\n\t\t\tif (start) {\n\t\t\t\tconst end = this.editor.getPosition();\n\t\t\t\tthis.editor.setSelection(Selection.fromPositions(start.getStartPosition(), end));\n\t\t\t\tthis.cancelSelectionAnchor();\n\t\t\t}\n\t\t}\n\t}\n\n\tcancelSelectionAnchor(): void {\n\t\tif (this.decorationId) {\n\t\t\tconst decorationId = this.decorationId;\n\t\t\tthis.editor.changeDecorations((accessor) => {\n\t\t\t\taccessor.removeDecoration(decorationId);\n\t\t\t\tthis.decorationId = undefined;\n\t\t\t});\n\t\t\tthis.selectionAnchorSetContextKey.set(false);\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tthis.cancelSelectionAnchor();\n\t\tthis.modelChangeListener.dispose();\n\t}\n}\n\nclass SetSelectionAnchor extends EditorAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.setSelectionAnchor',\n\t\t\tlabel: localize2('setSelectionAnchor', \"Set Selection Anchor\"),\n\t\t\tprecondition: undefined,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(KeyMod.CtrlCmd | KeyCode.KeyK, KeyMod.CtrlCmd | KeyCode.KeyB),\n\t\t\t\tweight: KeybindingWeight.EditorContrib\n\t\t\t}\n\t\t});\n\t}\n\n\tasync run(_accessor: ServicesAccessor, editor: ICodeEditor): Promise<void> {\n\t\tSelectionAnchorController.get(editor)?.setSelectionAnchor();\n\t}\n}\n\nclass GoToSelectionAnchor extends EditorAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.goToSelectionAnchor',\n\t\t\tlabel: localize2('goToSelectionAnchor', \"Go to Selection Anchor\"),\n\t\t\tprecondition: SelectionAnchorSet,\n\t\t});\n\t}\n\n\tasync run(_accessor: ServicesAccessor, editor: ICodeEditor): Promise<void> {\n\t\tSelectionAnchorController.get(editor)?.goToSelectionAnchor();\n\t}\n}\n\nclass SelectFromAnchorToCursor extends EditorAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.selectFromAnchorToCursor',\n\t\t\tlabel: localize2('selectFromAnchorToCursor', \"Select from Anchor to Cursor\"),\n\t\t\tprecondition: SelectionAnchorSet,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyChord(KeyMod.CtrlCmd | KeyCode.KeyK, KeyMod.CtrlCmd | KeyCode.KeyK),\n\t\t\t\tweight: KeybindingWeight.EditorContrib\n\t\t\t}\n\t\t});\n\t}\n\n\tasync run(_accessor: ServicesAccessor, editor: ICodeEditor): Promise<void> {\n\t\tSelectionAnchorController.get(editor)?.selectFromAnchorToCursor();\n\t}\n}\n\nclass CancelSelectionAnchor extends EditorAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.cancelSelectionAnchor',\n\t\t\tlabel: localize2('cancelSelectionAnchor', \"Cancel Selection Anchor\"),\n\t\t\tprecondition: SelectionAnchorSet,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyCode.Escape,\n\t\t\t\tweight: KeybindingWeight.EditorContrib\n\t\t\t}\n\t\t});\n\t}\n\n\tasync run(_accessor: ServicesAccessor, editor: ICodeEditor): Promise<void> {\n\t\tSelectionAnchorController.get(editor)?.cancelSelectionAnchor();\n\t}\n}\n\nregisterEditorContribution(SelectionAnchorController.ID, SelectionAnchorController, EditorContributionInstantiation.Lazy);\nregisterEditorAction(SetSelectionAnchor);\nregisterEditorAction(GoToSelectionAnchor);\nregisterEditorAction(SelectFromAnchorToCursor);\nregisterEditorAction(CancelSelectionAnchor);\n"]}